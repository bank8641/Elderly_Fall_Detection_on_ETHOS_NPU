<!--
SPDX-FileCopyrightText: Copyright 2020-2025 Arm Limited and/or its affiliates <open-source-office@arm.com>

SPDX-License-Identifier: Apache-2.0

Licensed under the Apache License, Version 2.0 (the License); you may
not use this file except in compliance with the License.
You may obtain a copy of the License at

www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an AS IS BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

# Supported Ops

This file was automatically generated by Vela using the `--supported-ops-report` parameter.  
Vela version: `4.5.0`

This file complies with
[**Gitiles Markdown syntax**](https://gerrit.googlesource.com/gitiles/+/HEAD/Documentation/markdown.md)

Summary table of constraints for:
- [Ethos-U55 and Ethos-U65 TFLite](#ethos-u55-and-ethos-u65-tflite-summary-table)
- [Ethos-U85 TFLite](#ethos-u85-tflite-summary-table)

## Ethos-U55 and Ethos-U65 TFLite Summary Table

The table below contains TFLite operators that can be placed on the Ethos-U55 and Ethos-U65.  
If the constraints are not met, then that operator will be scheduled on the CPU instead.  
For any other TFLite operator not listed, will be left untouched and scheduled on the CPU.  
Please check the supported operator list for your chosen runtime for further information.

| Operator | TFLite Constraints |
| --- | --- |
| ABS | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-abs-constraints) |
| ADD | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-add-constraints) |
| ARG_MAX | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-arg_max-constraints) |
| AVERAGE_POOL_2D | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-average_pool_2d-constraints) |
| CONCATENATION | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-concatenation-constraints) |
| CONV_2D | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-conv_2d-constraints) |
| DEPTHWISE_CONV_2D | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-depthwise_conv_2d-constraints) |
| EXP | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-exp-constraints) |
| EXPAND_DIMS | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-expand_dims-constraints) |
| FULLY_CONNECTED | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-fully_connected-constraints) |
| HARD_SWISH | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-hard_swish-constraints) |
| LEAKY_RELU | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-leaky_relu-constraints) |
| LOGISTIC | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| MAXIMUM | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-maximum-constraints) |
| MAX_POOL_2D | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-max_pool_2d-constraints) |
| MEAN | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-mean-constraints) |
| MINIMUM | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-minimum-constraints) |
| MIRROR_PAD | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-mirror_pad-constraints) |
| MUL | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-mul-constraints) |
| PACK | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| PAD | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-pad-constraints) |
| PRELU | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| QUANTIZE | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| RELU | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| RELU6 | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| RELU_0_TO_1 | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| RELU_N1_TO_1 | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| RESHAPE | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-reshape-constraints) |
| RESIZE_BILINEAR | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-resize_bilinear-constraints) |
| RESIZE_NEAREST_NEIGHBOR | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-resize_nearest_neighbor-constraints) |
| RSQRT | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-rsqrt-constraints) |
| SHAPE | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| SLICE | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-slice-constraints) |
| SOFTMAX | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-softmax-constraints) |
| SPLIT | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-split-constraints) |
| SPLIT_V | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-split_v-constraints) |
| SQUARED_DIFFERENCE | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-squared_difference-constraints) |
| SQUEEZE | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-squeeze-constraints) |
| STRIDED_SLICE | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-strided_slice-constraints) |
| SUB | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-sub-constraints) |
| TANH | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |
| TRANSPOSE | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-transpose-constraints) |
| TRANSPOSE_CONV | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-transpose_conv-constraints) |
| UNIDIRECTIONAL_SEQUENCE_LSTM | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints), [Specific](#ethos-u55-and-ethos-u65-tflite-unidirectional_sequence_lstm-constraints) |
| UNPACK | [Generic](#ethos-u55-and-ethos-u65-tflite-generic-constraints) |

## Ethos-U85 TFLite Summary Table

The table below contains TFLite operators that can be placed on the Ethos-U85.  
If the constraints are not met, then that operator will be scheduled on the CPU instead.  
For any other TFLite operator not listed, will be left untouched and scheduled on the CPU.  
Please check the supported operator list for your chosen runtime for further information.  

| Operator | TFLite Constraints |
| --- | --- |
| ABS | [Generic](#ethos-u85-tflite-generic-constraints) |
| ADD | [Generic](#ethos-u85-tflite-generic-constraints) |
| ARG_MAX | [Generic](#ethos-u85-tflite-generic-constraints) |
| AVERAGE_POOL_2D | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-average_pool_2d-constraints) |
| BATCH_MATMUL | [Generic](#ethos-u85-tflite-generic-constraints) |
| CAST | [Generic](#ethos-u85-tflite-generic-constraints) |
| CONCATENATION | [Generic](#ethos-u85-tflite-generic-constraints) |
| CONV_2D | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-conv_2d-constraints) |
| DEPTHWISE_CONV_2D | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-depthwise_conv_2d-constraints) |
| DIV | [Generic](#ethos-u85-tflite-generic-constraints) |
| EQUAL | [Generic](#ethos-u85-tflite-generic-constraints) |
| EXP | [Generic](#ethos-u85-tflite-generic-constraints) |
| EXPAND_DIMS | [Generic](#ethos-u85-tflite-generic-constraints) |
| FULLY_CONNECTED | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-fully_connected-constraints) |
| GATHER | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-gather-constraints) |
| GREATER | [Generic](#ethos-u85-tflite-generic-constraints) |
| GREATER_EQUAL | [Generic](#ethos-u85-tflite-generic-constraints) |
| HARD_SWISH | [Generic](#ethos-u85-tflite-generic-constraints) |
| LEAKY_RELU | [Generic](#ethos-u85-tflite-generic-constraints) |
| LESS_EQUAL | [Generic](#ethos-u85-tflite-generic-constraints) |
| LOG | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-log-constraints) |
| LOGICAL_AND | [Generic](#ethos-u85-tflite-generic-constraints) |
| LOGICAL_NOT | [Generic](#ethos-u85-tflite-generic-constraints) |
| LOGICAL_OR | [Generic](#ethos-u85-tflite-generic-constraints) |
| LOGISTIC | [Generic](#ethos-u85-tflite-generic-constraints) |
| MAXIMUM | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-maximum-constraints) |
| MAX_POOL_2D | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-max_pool_2d-constraints) |
| MEAN | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-mean-constraints) |
| MINIMUM | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-minimum-constraints) |
| MIRROR_PAD | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-mirror_pad-constraints) |
| MUL | [Generic](#ethos-u85-tflite-generic-constraints) |
| NOT_EQUAL | [Generic](#ethos-u85-tflite-generic-constraints) |
| PACK | [Generic](#ethos-u85-tflite-generic-constraints) |
| PAD | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-pad-constraints) |
| PADV2 | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-padv2-constraints) |
| PRELU | [Generic](#ethos-u85-tflite-generic-constraints) |
| QUANTIZE | [Generic](#ethos-u85-tflite-generic-constraints) |
| REDUCE_ALL | [Generic](#ethos-u85-tflite-generic-constraints) |
| REDUCE_ANY | [Generic](#ethos-u85-tflite-generic-constraints) |
| REDUCE_MAX | [Generic](#ethos-u85-tflite-generic-constraints) |
| REDUCE_MIN | [Generic](#ethos-u85-tflite-generic-constraints) |
| RELU | [Generic](#ethos-u85-tflite-generic-constraints) |
| RELU6 | [Generic](#ethos-u85-tflite-generic-constraints) |
| RELU_0_TO_1 | [Generic](#ethos-u85-tflite-generic-constraints) |
| RELU_N1_TO_1 | [Generic](#ethos-u85-tflite-generic-constraints) |
| RESHAPE | [Generic](#ethos-u85-tflite-generic-constraints) |
| RESIZE_BILINEAR | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-resize_bilinear-constraints) |
| RESIZE_NEAREST_NEIGHBOR | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-resize_nearest_neighbor-constraints) |
| REVERSE_V2 | [Generic](#ethos-u85-tflite-generic-constraints) |
| RSQRT | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-rsqrt-constraints) |
| SCATTER_ND | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-scatter_nd-constraints) |
| SELECT | [Generic](#ethos-u85-tflite-generic-constraints) |
| SELECT_V2 | [Generic](#ethos-u85-tflite-generic-constraints) |
| SLICE | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-slice-constraints) |
| SOFTMAX | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-softmax-constraints) |
| SPLIT | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-split-constraints) |
| SPLIT_V | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-split_v-constraints) |
| SQUARED_DIFFERENCE | [Generic](#ethos-u85-tflite-generic-constraints) |
| SQUEEZE | [Generic](#ethos-u85-tflite-generic-constraints) |
| STRIDED_SLICE | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-strided_slice-constraints) |
| SUB | [Generic](#ethos-u85-tflite-generic-constraints) |
| SUM | [Generic](#ethos-u85-tflite-generic-constraints) |
| TANH | [Generic](#ethos-u85-tflite-generic-constraints) |
| TILE | [Generic](#ethos-u85-tflite-generic-constraints) |
| TRANSPOSE | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-transpose-constraints) |
| TRANSPOSE_CONV | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-transpose_conv-constraints) |
| UNIDIRECTIONAL_SEQUENCE_LSTM | [Generic](#ethos-u85-tflite-generic-constraints), [Specific](#ethos-u85-tflite-unidirectional_sequence_lstm-constraints) |
| UNPACK | [Generic](#ethos-u85-tflite-generic-constraints) |

## Ethos-U55 and Ethos-U65 TFLite Generic Constraints

This is a list of constraints that most operators must satisfy in order to be scheduled on the NPU.  
(Operators excluded from certain constraints are listed as exceptions )

- All required operator attributes must be specified
- Input(s) and Output tensors must not be dynamic
  - Exceptions:  - [QUANTIZE]
- Input(s) and Output tensors must have a defined shape
- Output tensors cannot be scalar
  - Exceptions:  - [QUANTIZE]
- Scalar Input tensors are only valid for op type: ADD, ARG_MAX, EXPAND_DIMS, MAXIMUM, MEAN, MINIMUM, MUL, QUANTIZE, SPLIT, SPLIT_V, SUB
- Input(s) and Output tensors must not be greater than 4D
- Input(s), Output and Weight tensors must have quantization parameters
  - Exceptions:  - [ARG_MAX, MIRROR_PAD, SHAPE, TRANSPOSE]
- Input(s), Output and Weight tensors with quantization scales must be finite
- Input and Output tensors must have quantization scales that fit within float32 precision
- Constant tensors should not have NoneType-values
- Tensors must be of type: int16, int32, int8, uint8
  - Exceptions:  - [ARG_MAX]
- Tensors which are int32 are only valid when op type is: ADD, ARG_MAX, MIRROR_PAD, MUL, SHAPE, SUB, TRANSPOSE
- Tensor dimensions must be in the range [1, 65535]
- Per-axis quantization is only supported for the following op types: CONV_2D, DEPTHWISE_CONV_2D, FULLY_CONNECTED, TRANSPOSE_CONV
- IFM Tensor batch size must be 1
  - Exceptions:  - [FULLY_CONNECTED, RESHAPE, SHAPE, SLICE, SOFTMAX, SPLIT, SPLIT_V, SQUEEZE, STRIDED_SLICE, UNPACK]
- The fused activation function (if present) must be one of type: LOGISTIC, RELU, RELU6, RELU_0_TO_1, RELU_N1_TO_1, TANH
- If a fused activation function is present, the Output tensor must be one of type: int16, int8, uint8

## Ethos-U55 and Ethos-U65 Specific Operator constraints

### Ethos-U55 and Ethos-U65 TFLite ABS Constraints

This is a list of constraints that the ABS operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape
- IFM and OFM data types must match

### Ethos-U55 and Ethos-U65 TFLite ADD Constraints

This is a list of constraints that the ADD operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape
- Both Input data types must match
- For IFM that are signed, OFM must also be signed
- For IFM that are unsigned, OFM must either be the same type or int32
- Broadcasting is only allowed for rank indices with dimension 1, from either IFM1 or IFM2

### Ethos-U55 and Ethos-U65 TFLite ARG_MAX Constraints

This is a list of constraints that the ARG_MAX operator must satisfy in order to be scheduled on the NPU.

- IFM must be int8 or uint8
- OFM must be int32 or int64
- Operation must be performed along the depth axis
- IFM depth must be no greater than 127

### Ethos-U55 and Ethos-U65 TFLite AVERAGE_POOL_2D Constraints

This is a list of constraints that the AVERAGE_POOL_2D operator must satisfy in order to be scheduled on the NPU.

- Stride values for both width and height must be integer types
- IFM and OFM data types must match
- Kernel filter values for both width and height must be integer types
- Strides must fulfil the following criteria:  
        - Stride h must be between 1 and 3 when ofm height is greater than 1  
        - Stride w must be between 1 and 3 when ofm height is greater than 1 or  
          stride w must be divisible by 2 or 3 and ifm width must be divisible  
          by stride_w/2 or stride_w/3
- Stride width must be greater than or equal to 1.  
        For stride width greater than 3, valid padding needs to be used.
- Kernel filter values for both width and height must be in the range [1, 8]
- VALID padding: Kernel filter height must be in the range [1, 256]
- VALID padding: Product of kernel filter width and height must be in the range [1, 65536]

### Ethos-U55 and Ethos-U65 TFLite CONCATENATION Constraints

This is a list of constraints that the CONCATENATION operator must satisfy in order to be scheduled on the NPU.

- Axis attribute must exist
- Axis attribute must be in the range [0, <ofm_dimensions>)
- All Input dimensionalities must match OFM dimensionality
- All Input dimensions must match OFM dimension in all axes except the one defined by the axis attribute
- The size of the OFM axis must match the sum of all IFM axis defined by the axis attribute

### Ethos-U55 and Ethos-U65 TFLite CONV_2D Constraints

This is a list of constraints that the CONV_2D operator must satisfy in order to be scheduled on the NPU.

- Stride values for both width and height must be integer types
- IFM depth must be a whole multiple of the filter kernel depth
- Number of filter kernels must be equally divisible by the number of convolution groups
- Dilation factor values for both width and height must be integer types
- Strides must fulfil the following criteria:  
        - Stride h must be between 1 and 3 when ofm height is greater than 1  
        - Stride w must be between 1 and 3 when ofm height is greater than 1 or  
          stride w must be divisible by 2 or 3 and ifm width must be divisible  
          by stride_w/2 or stride_w/3
- Dilated kernel height must be in the range [1, 64]
- Product of dilated kernel width and height must be in the range [1, 4096]
- Weight tensor must be 8-bit
- Weight tensor must be constant
- The sum of the weights cannot exceed 8323072
- Optional Bias tensor must be of shape: 1D
- Optional Bias tensor must be of type: int32, int64
- Optional Bias tensor values must fit within 40-bits

### Ethos-U55 and Ethos-U65 TFLite DEPTHWISE_CONV_2D Constraints

This is a list of constraints that the DEPTHWISE_CONV_2D operator must satisfy in order to be scheduled on the NPU.

- Stride values for both width and height must be integer types
- Dilation factor values for both width and height must be integer types
- Dilated kernel height must be in the range [1, 64]
- Product of dilated kernel width and height must be in the range [1, 4096]
- Weight tensor must be 8-bit
- Weight tensor must be constant
- The sum of the weights cannot exceed 8323072
- Optional Bias tensor must be of shape: 1D
- Optional Bias tensor must be of type: int32, int64
- Optional Bias tensor values must fit within 40-bits
- Stride values for both width and height must be between 1 and 3
- For depth multipliers > 1, IFM channels must be 1 and OFM channels must be equal to the depth multiplier

### Ethos-U55 and Ethos-U65 TFLite EXP Constraints

This is a list of constraints that the EXP operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape
- IFM and OFM data types must match
- IFM must be int8 or int16

### Ethos-U55 and Ethos-U65 TFLite EXPAND_DIMS Constraints

This is a list of constraints that the EXPAND_DIMS operator must satisfy in order to be scheduled on the NPU.

- Input and output quantisation must match.
- Input and output number of elements must match.

### Ethos-U55 and Ethos-U65 TFLite FULLY_CONNECTED Constraints

This is a list of constraints that the FULLY_CONNECTED operator must satisfy in order to be scheduled on the NPU.

- The output tensor(s) must have 2D shape
- The IFM and OFM must have the same number of dimensions if keep_num_dims is set to true
- Weight tensor must be 8-bit
- Weight tensor must be constant
- Optional Bias tensor must be of shape: 1D
- Optional Bias tensor must be of type: int32, int64
- Optional Bias tensor values must fit within 40-bits

### Ethos-U55 and Ethos-U65 TFLite HARD_SWISH Constraints

This is a list of constraints that the HARD_SWISH operator must satisfy in order to be scheduled on the NPU.

- IFM must be int8 or uint8
- IFM and OFM data types must match

### Ethos-U55 and Ethos-U65 TFLite LEAKY_RELU Constraints

This is a list of constraints that the LEAKY_RELU operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape
- IFM and OFM data types must match

### Ethos-U55 and Ethos-U65 TFLite MAXIMUM Constraints

This is a list of constraints that the MAXIMUM operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape
- IFM and OFM data types must match
- Both Input quantization parameters must match OFM quantization parameters
- Broadcasting is only allowed for rank indices with dimension 1, from either IFM1 or IFM2

### Ethos-U55 and Ethos-U65 TFLite MAX_POOL_2D Constraints

This is a list of constraints that the MAX_POOL_2D operator must satisfy in order to be scheduled on the NPU.

- Stride values for both width and height must be integer types
- IFM and OFM data types must match
- Kernel filter values for both width and height must be integer types
- Stride values for both width and height must be in the range [1, 3]
- Kernel filter height must be in the range [1, 256]
- Product of kernel filter width and height must be in the range [1, 65536]

### Ethos-U55 and Ethos-U65 TFLite MEAN Constraints

This is a list of constraints that the MEAN operator must satisfy in order to be scheduled on the NPU.

- Input tensor must be at least 2D
- Requirements for axis parameter:  
        When IFM tensor is 2D:  
          - Reduction in both axes is supported.  
        When IFM tensor is 3D or 4D:  
          - Reduction in Batch axis is only supported if batch size is 1.  
          - Reduction in both Height and Width axes is supported.  
          - Reduction in Depth axis is supported if at least one of H,W,C are of size 1.
- Product of reduced axes must be no greater than:  
        - 16777216 for signed 8-bit inputs.  
        - 8388608 for unsigned 8-bit inputs.  
        - 65536 for signed 16-bit inputs.
- If Width axis is reduced its shape must be no greater than 4096.
- If Depth axis is reduced its shape must be no greater than 4096.

### Ethos-U55 and Ethos-U65 TFLite MINIMUM Constraints

This is a list of constraints that the MINIMUM operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape
- IFM and OFM data types must match
- Both Input quantization parameters must match OFM quantization parameters
- Broadcasting is only allowed for rank indices with dimension 1, from either IFM1 or IFM2

### Ethos-U55 and Ethos-U65 TFLite MIRROR_PAD Constraints

This is a list of constraints that the MIRROR_PAD operator must satisfy in order to be scheduled on the NPU.

- The padding tensor must have the shape [3,2] or [4,2]
- Pad tensor must be of type: int32, int64
- The pad tensor can only pad width and height
- The number of pad values for each direction must not be larger than the ifm size in that dimension

### Ethos-U55 and Ethos-U65 TFLite MUL Constraints

This is a list of constraints that the MUL operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape
- Both Input data types must match
- For IFM that are signed, OFM must also be signed
- For IFM that are unsigned, OFM must either be the same type or int32
- Broadcasting is only allowed for rank indices with dimension 1, from either IFM1 or IFM2

### Ethos-U55 and Ethos-U65 TFLite PAD Constraints

This is a list of constraints that the PAD operator must satisfy in order to be scheduled on the NPU.

- Number of input tensors must be exactly 2
- The padding tensor must be constant
- Shape of output tensor must equal to size of input tensor plus padding
- The padding tensor must have the shape [3,2] or [4,2]
- Pad tensor must be of type: int32, int64
- The pad tensor can only pad height, width and depth

### Ethos-U55 and Ethos-U65 TFLite RESHAPE Constraints

This is a list of constraints that the RESHAPE operator must satisfy in order to be scheduled on the NPU.

- Input and output quantisation must match.
- Input and output number of elements must match.
- Shape must be constant

### Ethos-U55 and Ethos-U65 TFLite RESIZE_BILINEAR Constraints

This is a list of constraints that the RESIZE_BILINEAR operator must satisfy in order to be scheduled on the NPU.

- The width and height of the IFM and OFM must match one of the following criteria:  
        IFM W and H must both be 1  
        IFM must match OFM  
        W and H scaling must be either 1 or equal and OFM W-1 and H-1 must be 1x/2x/4x/8x IFM W-1 and H-1, if align_corners is True  
        W and H scaling must be either 1 or equal and OFM W and H must be 1x/2x/4x/8x IFM W and H, if align_corners is False
- The size tensor must match the output tensor shape
- Both align_corners and half_pixel_centers can't be True
- For half_pixel_centers the width and height of the IFM and OFM must match one of the following criteria:  
        IFM W and H are both 1  
        OFM W and H is 2x IFM W and H

### Ethos-U55 and Ethos-U65 TFLite RESIZE_NEAREST_NEIGHBOR Constraints

This is a list of constraints that the RESIZE_NEAREST_NEIGHBOR operator must satisfy in order to be scheduled on the NPU.

- The width and height of the IFM and OFM must match one of the following criteria:  
        IFM W and H must both be 1  
        IFM must match OFM  
        W and H scaling must be either 1 or equal and OFM W-1 and H-1 must be 1x/2x/4x/8x IFM W-1 and H-1, if align_corners is True  
        W and H scaling must be either 1 or equal and OFM W and H must be 1x/2x/4x/8x IFM W and H, if align_corners is False
- The size tensor must match the output tensor shape
- Both align_corners and half_pixel_centers can't be True

### Ethos-U55 and Ethos-U65 TFLite RSQRT Constraints

This is a list of constraints that the RSQRT operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape
- IFM and OFM data types must match
- IFM must be int8

### Ethos-U55 and Ethos-U65 TFLite SLICE Constraints

This is a list of constraints that the SLICE operator must satisfy in order to be scheduled on the NPU.

- Begin and Size Input tensors must be constant

### Ethos-U55 and Ethos-U65 TFLite SOFTMAX Constraints

This is a list of constraints that the SOFTMAX operator must satisfy in order to be scheduled on the NPU.

- IFM and OFM shapes must match
- IFM and OFM data types must match
- Beta value needs to be positive
- The product of IFM width and height must be in the range [1, 65535]

### Ethos-U55 and Ethos-U65 TFLite SPLIT Constraints

This is a list of constraints that the SPLIT operator must satisfy in order to be scheduled on the NPU.

- Axis value must be in the range [-RANK(IFM) to +RANK(IFM))
- Axis must be divisible by number of splits

### Ethos-U55 and Ethos-U65 TFLite SPLIT_V Constraints

This is a list of constraints that the SPLIT_V operator must satisfy in order to be scheduled on the NPU.

- Only one size is allowed to be inferred

### Ethos-U55 and Ethos-U65 TFLite SQUARED_DIFFERENCE Constraints

This is a list of constraints that the SQUARED_DIFFERENCE operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape

### Ethos-U55 and Ethos-U65 TFLite SQUEEZE Constraints

This is a list of constraints that the SQUEEZE operator must satisfy in order to be scheduled on the NPU.

- Input and output quantisation must match.
- Input and output number of elements must match.

### Ethos-U55 and Ethos-U65 TFLite STRIDED_SLICE Constraints

This is a list of constraints that the STRIDED_SLICE operator must satisfy in order to be scheduled on the NPU.

- Exactly 4 Input tensors are required
- Begin, End and Stride Input tensors must be constant
- ellipsis_mask must be 0
- new_axis_mask and shrink_axis_mask cannot both be set
- Slice 'end' values must be greater than 'begin' values
- Batch and channel stride values must be 1
- Offset attribute must be False

### Ethos-U55 and Ethos-U65 TFLite SUB Constraints

This is a list of constraints that the SUB operator must satisfy in order to be scheduled on the NPU.

- At least one Input's shape must match the OFM's shape
- Both Input data types must match
- For IFM that are signed, OFM must also be signed
- For IFM that are unsigned, OFM must either be the same type or int32
- Broadcasting is only allowed for rank indices with dimension 1, from either IFM1 or IFM2

### Ethos-U55 and Ethos-U65 TFLite TRANSPOSE Constraints

This is a list of constraints that the TRANSPOSE operator must satisfy in order to be scheduled on the NPU.

- Permutation array must be a 1D tensor with RANK(IFM) elements
- Permutation array must have constant values in the range [0, RANK(IFM))
- The following shape/permutations are supported for transpose:  
        When ifm rank is 2: WxC -> CxW  
        When ifm rank is 3: HxWxC -> WxHxC, 1xWxC -> 1xCxW, Hx1xC -> Cx1xH  
        When ifm rank is 4: 1xHxWxC -> 1xWxHxC, 1x1xWxC -> 1x1xCxW, 1xHx1xC -> 1xCx1xW

### Ethos-U55 and Ethos-U65 TFLite TRANSPOSE_CONV Constraints

This is a list of constraints that the TRANSPOSE_CONV operator must satisfy in order to be scheduled on the NPU.

- Stride values for both width and height must be integer types
- Dilated kernel height must be in the range [1, 64]
- Product of dilated kernel width and height must be in the range [1, 4096]
- Weight tensor must be 8-bit
- Weight tensor must be constant
- The sum of the weights cannot exceed 8323072
- Optional Bias tensor must be of shape: 1D
- Optional Bias tensor must be of type: int32, int64
- Optional Bias tensor values must fit within 40-bits
- Stride values for width and height must match one of the following criteria:  
        Stride values WxH must be 1x1 or 2x2  
        Stride WxH 2x1 supported if ifm height and kernel height = 1
- SAME padding: OFM dimensions must equal IFM dimensions multiplied by stride
- VALID padding: OFM dimensions must equal IFM dimensions multiplied by stride,  
        minus difference between kernel size and stride

### Ethos-U55 and Ethos-U65 TFLite UNIDIRECTIONAL_SEQUENCE_LSTM Constraints

This is a list of constraints that the UNIDIRECTIONAL_SEQUENCE_LSTM operator must satisfy in order to be scheduled on the NPU.

- IFM must be int8 or int16
- IFM and OFM data types must match
- IFM and OFM must have 3D shape
- Must have 24 input tensors
- Must have 5 intermediate tensors
- State tensors must be variable
- Must not use CIFG
- Must not use Peephole
- Must not use Projection
- Must not use Normalisation
- All input and recurrent weights must be available
- All recurrent weights must be 2D

## Ethos-U85 TFLite Generic Constraints

This is a list of constraints that most operators must satisfy in order to be scheduled on the NPU.  
(Operators excluded from certain constraints are listed as exceptions )


- Feature-map dataTypes must be one of {"BOOL", "INT16", "INT32", "INT64", "INT8", "UINT8"}
- Operations must have at least one IFM.
- Operations must have at least one OFM.
- Tensors must have constant shape.
- Only the first dimension of tensors can be dynamic.
- Input(s), Output and Weight tensors must have quantization parameters.
  - Exceptions: [SCATTER_ND, QUANTIZE, PADV2, PAD, MIRROR_PAD, TRANSPOSE, EXPAND_DIMS, REDUCE_ANY, GATHER, SELECT, REDUCE_ALL, SELECT_V2, ARGMAX]
- Per-axis quantization is not supported.
  - Exceptions: [FULLY_CONNECTED, CONV_2D, TRANSPOSE_CONV, DEPTHWISE_CONV_2D]
- IFM Zero-points must be in the range:
  - Int8: (-128 <= zp <= 127).
  - UInt8: (0 <= zp <= 255).
  - UInt16: zp must be 0 or 32768.
  - Other: zp must be 0.
  - Exceptions: [UNIDIRECTIONAL_SEQUENCE_LSTM, RESIZE_NEAREST_NEIGHBOR, RESIZE_BILINEAR, AVERAGE_POOL_2D, DIV]
- OFM Zero-points must be in the range:
  - Signed-integer: (-128 <= zp <= 127)
  - Unsigned-integer: (0 <= zp <= 255) OR zp == 32768.
  - Exceptions: [UNIDIRECTIONAL_SEQUENCE_LSTM, RESIZE_NEAREST_NEIGHBOR, RESIZE_BILINEAR, AVERAGE_POOL_2D, DIV]

## Ethos-U85 Specific Operator Constraints

### Ethos-U85 TFLite AVERAGE_POOL_2D Constraints

This is a list of constraints that the AVERAGE_POOL_2D operator must satisfy in order to be scheduled on the NPU.

- Kernel constraints:
  - IF padding=VALID:
    - Kernel product must be less than or equal to 256*256
    - Kernel height must be less than or equal to 256.
  - ELSE:
    - Kernel width and height must be less than or equal to 8

### Ethos-U85 TFLite CONV_2D Constraints

This is a list of constraints that the CONV_2D operator must satisfy in order to be scheduled on the NPU.

- Bias tensors must be constant
- Bias tensors precision must be Int32 or Int64
- Bias values must be stored in the channel axis
- Int64 bias must be smaller than 281474976710655
- Weight tensors must be 8-bit precision
- Weigth sum constraints:
  - IF 8-bit IFM:
    - The sum of absolute weights cannot exceed 8323072
  - IF 16-bit IFM:
    - The sum of absolute weights cannot exceed 2130706432

### Ethos-U85 TFLite DEPTHWISE_CONV_2D Constraints

This is a list of constraints that the DEPTHWISE_CONV_2D operator must satisfy in order to be scheduled on the NPU.

- Bias tensors must be constant
- Bias tensors precision must be Int32 or Int64
- Bias values must be stored in the channel axis
- Int64 bias must be smaller than 281474976710655
- Weight tensors must be 8-bit precision
- Weigth sum constraints:
  - IF 8-bit IFM:
    - The sum of absolute weights cannot exceed 8323072
  - IF 16-bit IFM:
    - The sum of absolute weights cannot exceed 2130706432

### Ethos-U85 TFLite FULLY_CONNECTED Constraints

This is a list of constraints that the FULLY_CONNECTED operator must satisfy in order to be scheduled on the NPU.

- Bias tensors must be constant
- Bias tensors precision must be Int32 or Int64
- Bias values must be stored in the channel axis
- FullyConnected weights must be on the form O,1,1,..,1,I.
- Int64 bias must be smaller than 281474976710655
- Weight tensors must be 8-bit precision
- Weigth sum constraints:
  - IF 8-bit IFM:
    - The sum of absolute weights cannot exceed 8323072
  - IF 16-bit IFM:
    - The sum of absolute weights cannot exceed 2130706432

### Ethos-U85 TFLite GATHER Constraints

This is a list of constraints that the GATHER operator must satisfy in order to be scheduled on the NPU.

- axis must be equal to batch_dims

### Ethos-U85 TFLite LOG Constraints

This is a list of constraints that the LOG operator must satisfy in order to be scheduled on the NPU.

- IFM and OFM datatypes must match, and must be Int8 or Int16
- IFM and OFM shapes must match

### Ethos-U85 TFLite MAXIMUM Constraints

This is a list of constraints that the MAXIMUM operator must satisfy in order to be scheduled on the NPU.

- Both Input quantization parameters must match OFM quantization parameters

### Ethos-U85 TFLite MAX_POOL_2D Constraints

This is a list of constraints that the MAX_POOL_2D operator must satisfy in order to be scheduled on the NPU.

- kernel product must be less than or equal to 256*256 and kernel height must be less than or equal to 256.

### Ethos-U85 TFLite MEAN Constraints

This is a list of constraints that the MEAN operator must satisfy in order to be scheduled on the NPU.

- Amount of reduced elements cannot exceed: 16777216(Int8), 8388608(UInt8), 65536(Int16).
- Batch must be 1.
- IFM precision must be one of: (Int8, UInt8, Int16)
- Parameter tensors must be constant
- Reduced axis must be less than 4096
- Reduction over depth is only supported if any of h,w,c == 1

### Ethos-U85 TFLite MINIMUM Constraints

This is a list of constraints that the MINIMUM operator must satisfy in order to be scheduled on the NPU.

- Both Input quantization parameters must match OFM quantization parameters

### Ethos-U85 TFLite MIRROR_PAD Constraints

This is a list of constraints that the MIRROR_PAD operator must satisfy in order to be scheduled on the NPU.

- Parameter tensors must be constant
- Params tensor must be Int32 or Int64

### Ethos-U85 TFLite PAD Constraints

This is a list of constraints that the PAD operator must satisfy in order to be scheduled on the NPU.

- Parameter tensors must be constant
- Params tensor must be Int32 or Int64

### Ethos-U85 TFLite PADV2 Constraints

This is a list of constraints that the PADV2 operator must satisfy in order to be scheduled on the NPU.

- Parameter tensors must be constant
- Params tensor must be Int32 or Int64

### Ethos-U85 TFLite RESIZE_BILINEAR Constraints

This is a list of constraints that the RESIZE_BILINEAR operator must satisfy in order to be scheduled on the NPU.

- Scale-factor must be an integer power of two.
- Scale-factor:
  - IF align_corners:
    - Scale-factor can be maximum 2048
  - ELSE:
    - Scale-factor can be maximum 1024.
- align_corners and half_pixel_centers are mutually exclusive.

### Ethos-U85 TFLite RESIZE_NEAREST_NEIGHBOR Constraints

This is a list of constraints that the RESIZE_NEAREST_NEIGHBOR operator must satisfy in order to be scheduled on the NPU.

- Scale-factor:
  - IF align_corners:
    - Scale-factor can be maximum 2048
  - ELSE:
    - Scale-factor can be maximum 1024.
- align_corners and half_pixel_centers are mutually exclusive.

### Ethos-U85 TFLite RSQRT Constraints

This is a list of constraints that the RSQRT operator must satisfy in order to be scheduled on the NPU.

- IFM must be Int8 or Int16

### Ethos-U85 TFLite SCATTER_ND Constraints

This is a list of constraints that the SCATTER_ND operator must satisfy in order to be scheduled on the NPU.

- Index tensor elements must be unique
- Index tensor must be constant
- Index tensor must have channel=1
- Shape tensor must be constant

### Ethos-U85 TFLite SLICE Constraints

This is a list of constraints that the SLICE operator must satisfy in order to be scheduled on the NPU.

- Parameter tensors must be constant

### Ethos-U85 TFLite SOFTMAX Constraints

This is a list of constraints that the SOFTMAX operator must satisfy in order to be scheduled on the NPU.

- The product of IFM width and height must be less than 65536

### Ethos-U85 TFLite SPLIT Constraints

This is a list of constraints that the SPLIT operator must satisfy in order to be scheduled on the NPU.

- num_splits must match the number of outputs.

### Ethos-U85 TFLite SPLIT_V Constraints

This is a list of constraints that the SPLIT_V operator must satisfy in order to be scheduled on the NPU.

- num_splits must match the number of outputs.

### Ethos-U85 TFLite STRIDED_SLICE Constraints

This is a list of constraints that the STRIDED_SLICE operator must satisfy in order to be scheduled on the NPU.

- Parameter tensors must be constant
- Slice must represent a volume. Stride must be non-negative (and over W or H).

### Ethos-U85 TFLite TRANSPOSE Constraints

This is a list of constraints that the TRANSPOSE operator must satisfy in order to be scheduled on the NPU.

- Parameter tensors must be constant
- Tensor dimension must be <= 8

### Ethos-U85 TFLite TRANSPOSE_CONV Constraints

This is a list of constraints that the TRANSPOSE_CONV operator must satisfy in order to be scheduled on the NPU.

- Bias tensors must be constant
- Bias tensors precision must be Int32 or Int64
- Bias values must be stored in the channel axis
- Int64 bias must be smaller than 281474976710655
- Shape constraints:
  - IF PADDING=SAME:
    - OFM must be equal to IFM * stride
  - ELSE:
    - OFM must be equal to IFM * stride + (kernel - stride)
- Weight tensors must be 8-bit precision
- Weigth sum constraints:
  - IF 8-bit IFM:
    - The sum of absolute weights cannot exceed 8323072
  - IF 16-bit IFM:
    - The sum of absolute weights cannot exceed 2130706432

### Ethos-U85 TFLite UNIDIRECTIONAL_SEQUENCE_LSTM Constraints

This is a list of constraints that the UNIDIRECTIONAL_SEQUENCE_LSTM operator must satisfy in order to be scheduled on the NPU.

- Gate normalization is not supported.
- Implicit gate calculation is not supported.
- Peephole variant is not supported.
- Projection is not supported.
